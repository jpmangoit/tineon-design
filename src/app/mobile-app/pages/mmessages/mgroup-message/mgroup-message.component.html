<div class="card group_msg_main" *ngIf="isGroupList == true">
    <div class="card-body ">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="tab-content">
                    <div class="tab-pane active">
                        <ng-container>
                            <div class="feature_tab">

                                <!-- <mat-form-field appearance="fill">
                                    <mat-label>{{language.create_task.select_placeholder}}</mat-label>
                                    <mat-select>
                                        <mat-option *ngFor="let selections of select" [value]="selections.value"
                                            [selected]="value == 1" (click)="onSelect(selections.value)">
                                            {{selections.viewValue}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field> -->
                            </div>
                            <ng-container *ngIf="groupInbox">

                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                            <!-- user group info -->
                                            <!-- chat sidebar widget start -->
                                            <div class="widget-chat widget">
                                                <!-- user group info inner -->
                                                <div class="widget-app-content" *ngFor='let msg of groupMessage'>
                                                    <div class="app-main-content"
                                                        (click)="clickMessages(msg.id, msg.esdb_id)"
                                                        id="message-{{msg.id}}">
                                                        <div class="app-left-content">
                                                            <div class="user-img" *ngIf="msg.group">
                                                                <img onContextMenu="return false;" alt="" loading="lazy"
                                                                    [src]=" msg.group.image ?  msg.group.image : 'assets/img/defaultProfile.jpeg'">
                                                            </div>
                                                            <div class="user-content">
                                                                <span class="user-name"
                                                                    *ngIf="msg.user">{{msg.user.firstName}}
                                                                    {{msg.user.lastName}} ({{msg.group.name}})</span>
                                                                <h6>{{msg.subject}}</h6>
                                                                <p>{{msg.content}}</p>
                                                            </div>
                                                        </div>
                                                        <div class="app-right-content">
                                                            <span class="seen-time">{{msg.created_at | date: 'd. MMMM y'
                                                                }} <br> {{msg.created_at | date: 'HH:mm': 'GMT+2' }}
                                                            </span>
                                                            <i *ngIf="msg.is_read == 0" id="envelope-{{msg.id}}"
                                                                class="fa fa-envelope-o" aria-hidden="true"></i>
                                                            <i *ngIf="msg.is_read == 1" id="envelope-open-{{msg.id}}"
                                                                class="fa fa-envelope-open-o" aria-hidden="true"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- user group info inner -->
                                            </div>
                                            <!-- user group info End-->
                                            <div class="chat-bottom-overlay"></div>
                                        </div>
                                        <!-- <div class="chat-divider"></div> -->
                                    </div>

                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupStarred">

                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupStarredMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                            <!-- user group info -->
                                            <!-- chat sidebar widget start -->
                                            <div class="widget-chat widget">
                                                <!-- user group info inner -->
                                                <div class="widget-app-content" *ngFor='let msg of groupMessage'>
                                                    <div class="app-main-content"
                                                        (click)="clickMessages(msg.id, msg.esdb_id)"
                                                        id="message-{{msg.id}}">
                                                        <div class="app-left-content">
                                                            <div class="user-img" *ngIf="msg.group">
                                                                <img onContextMenu="return false;" alt="" loading="lazy"
                                                                    [src]=" msg.group.image ?  msg.group.image : 'assets/img/defaultProfile.jpeg'">
                                                            </div>
                                                            <div class="user-content">
                                                                <span class="user-name"
                                                                    *ngIf="msg.user">{{msg.user.firstName}}
                                                                    {{msg.user.lastName}}</span>
                                                                <h6>{{msg.subject}}</h6>
                                                                <p>{{msg.content}}</p>
                                                            </div>
                                                        </div>
                                                        <div class="app-right-content">
                                                            <span class="seen-time">{{msg.created_at | date: 'd. MMMM y'
                                                                }} <br> {{msg.created_at | date: 'HH:mm': 'GMT+2' }}
                                                            </span>
                                                            <i *ngIf="msg.is_read == 0" class="fa fa-envelope-o"
                                                                aria-hidden="true"></i>
                                                            <i *ngIf="msg.is_read == 1" class="fa fa-envelope-open-o"
                                                                aria-hidden="true"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- user group info inner -->
                                            </div>
                                            <!-- user group info End-->
                                            <div class="chat-bottom-overlay"></div>
                                        </div>
                                        <!-- <div class="chat-divider"></div> -->
                                    </div>

                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupSent">

                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupSentMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                            <!-- user group info -->
                                            <!-- chat sidebar widget start -->
                                            <div class="widget-chat widget">
                                                <!-- user group info inner -->
                                                <div class="widget-app-content" *ngFor='let msg of groupMessage'>
                                                    <div class="app-main-content"
                                                        (click)="clickMessages(msg.id, msg.esdb_id)"
                                                        id="message-{{msg.id}}">
                                                        <div class="app-left-content">
                                                            <div class="user-img" *ngIf="msg.group">
                                                                <img onContextMenu="return false;" alt="" loading="lazy"
                                                                    [src]=" msg.group.image ?  msg.group.image : 'assets/img/defaultProfile.jpeg'">
                                                            </div>
                                                            <!-- <div class="user-img" *ngIf="(msg.group.image) && (msg.group.image == null || msg.group.image == '')">
                                                            {{msg?.group.firstName.charAt(0)}} {{msg?.group.lastName.charAt(0)}}
                                                         </div> -->
                                                            <div class="user-content">
                                                                <span class="user-name"
                                                                    *ngIf="msg.user">{{msg.user.firstName}}
                                                                    {{msg.user.lastName}}</span>
                                                                <h6>{{msg.subject}}</h6>
                                                                <p>{{msg.content}}</p>
                                                            </div>
                                                        </div>
                                                        <div class="app-right-content">
                                                            <span class="seen-time">{{msg.created_at | date: 'd. MMMM y'
                                                                }} <br> {{msg.created_at | date: 'HH:mm': 'GMT+2' }}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- user group info inner -->
                                            </div>
                                            <!-- user group info End-->
                                            <div class="chat-bottom-overlay"></div>
                                        </div>
                                        <!-- <div class="chat-divider"></div> -->
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupDrafts">
                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupDraftMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="widget-chat widget">
                                                <div class="widget-app-content" *ngFor='let msg of groupMessage'>
                                                    <div class="app-main-content"
                                                        (click)="clickDraftMessages(msg.id, msg.esdb_id)"
                                                        id="message-{{msg.id}}">
                                                        <div class="app-left-content">
                                                            <div class="user-img" *ngIf="msg.group">
                                                                <img onContextMenu="return false;" alt="" loading="lazy"
                                                                    [src]=" msg.group.image ?  msg.group.image : 'assets/img/defaultProfile.jpeg'">
                                                            </div>
                                                            <div class="user-content">
                                                                <span class="user-name"
                                                                    *ngIf="msg.user">{{msg.user.firstName}}
                                                                    {{msg.user.lastName}}</span>
                                                                <h6>{{msg.subject}}</h6>
                                                                <p>{{msg.content}}</p>
                                                            </div>
                                                        </div>
                                                        <div class="app-right-content">
                                                            <span class="seen-time">{{msg.created_at | date: 'd. MMMM y'
                                                                }} <br> {{msg.created_at | date: 'HH:mm': 'GMT+2' }}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- user group info inner -->
                                            </div>
                                            <!-- user group info End-->
                                            <div class="chat-bottom-overlay"></div>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupAllMail">
                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupAllMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="widget-chat widget">
                                                <ng-container *ngFor='let msg of groupMessage'>
                                                    <div class="widget-app-content">
                                                        <div class="app-main-content"
                                                            (click)="clickMessages(msg.id, msg.esdb_id)"
                                                            id="message-{{msg.id}}">
                                                            <div class="app-left-content">
                                                                <div class="user-img" *ngIf="msg.group">
                                                                    <img onContextMenu="return false;" alt="" loading="lazy"
                                                                        [src]=" msg.group.image ?  msg.group.image : 'assets/img/defaultProfile.jpeg'">
                                                                </div>
                                                                <div class="user-content">
                                                                    <span class="user-name"
                                                                        *ngIf="msg.user">{{msg.user.firstName}}
                                                                        {{msg.user.lastName}}</span>
                                                                    <h6>{{msg.subject}}</h6>
                                                                    <p>{{msg.content}}</p>
                                                                </div>
                                                            </div>
                                                            <div class="app-right-content">
                                                                <span class="seen-time">{{msg.created_at | date: 'd. MMMM y' }} <br> {{msg.created_at | date: 'HH:mm': 'GMT+2'
                                                                    }} </span>
                                                                <i *ngIf="msg.is_read == 0" class="fa fa-envelope-o"
                                                                    aria-hidden="true"></i>
                                                                <i *ngIf="msg.is_read == 1"
                                                                    class="fa fa-envelope-open-o"
                                                                    aria-hidden="true"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                            </div>
                                            <div class="chat-bottom-overlay"></div>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupTrash">
                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupTrashMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="widget-chat widget">
                                                <div class="widget-app-content" *ngFor='let msg of groupMessage'>
                                                    <div class="app-main-content"
                                                        (click)="clickMessages(msg.id, msg.esdb_id)"
                                                        id="message-{{msg.id}}">
                                                        <div class="app-left-content">
                                                            <div class="user-img" *ngIf="msg.group">
                                                                <img onContextMenu="return false;" alt="" loading="lazy"
                                                                    [src]=" msg.group.image ?  msg.group.image : 'assets/img/defaultProfile.jpeg'">
                                                            </div>
                                                            <div class="user-content">
                                                                <span class="user-name"
                                                                    *ngIf="msg.user">{{msg.user.firstName}}
                                                                    {{msg.user.lastName}}</span>
                                                                <h6>{{msg.subject}}</h6>
                                                                <p>{{msg.content}}</p>
                                                            </div>
                                                        </div>
                                                        <div class="app-right-content">
                                                            <span class="seen-time">{{msg.created_at | date: 'd. MMMM y'
                                                                }} <br> {{msg.created_at | date: 'HH:mm': 'GMT+2' }}
                                                            </span>
                                                            <i *ngIf="msg.is_read == 0" class="fa fa-envelope-o"
                                                                aria-hidden="true"></i>
                                                            <i *ngIf="msg.is_read == 1" class="fa fa-envelope-open-o"
                                                                aria-hidden="true"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-bottom-overlay"></div>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="card group_msg_main" *ngIf="isGroupList == false">
    <div class="card-body ">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="tab-content">
                    <div class="tab-pane active">
                        <ng-container>
                            <div class="feature_tab back-message-btn">
                                <button type="button" (click)="back()">Back</button>
                            </div>
                            <!-- <div class="error alert alert-danger" *ngIf="responseMessage">{{responseMessage}}</div> -->
                            <ng-container *ngIf="groupInbox">
                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                        <div class="chat-content">
                                            <div class="inner-chat">
                                                <div class="chat-top-area">
                                                    <div class="chat-header">
                                                        <div class="chat-left">
                                                            <div class="chat-user-img-main">
                                                                <div class="chat-user-img-in">
                                                                    <div class="chat-user-img-in"
                                                                        *ngIf="selectedMessage[0].group">
                                                                        <img onContextMenu="return false;" alt="" loading="lazy"
                                                                            [src]=" selectedMessage[0].group.image ?  selectedMessage[0].group.image : 'assets/img/defaultProfile.jpeg'">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="user-detail-info">
                                                                <div class="chat-user-name"
                                                                    *ngIf="selectedMessage && selectedMessage[0]?.user" 
                                                                    tooltip="{{selectedMessage[0].user.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{selectedMessage[0].user.firstName}}
                                                                    {{selectedMessage[0].user.lastName}}"</div>
                                                                <div class="group_name"
                                                                    *ngIf="selectedMessage[0].group.id"> <a
                                                                        routerLink="/group-detail/{{selectedMessage[0].group.id}}">({{selectedMessage[0].group.name}})</a>
                                                                </div>
                                                                <div class="reply-date">{{selectedMessage[0].created_at
                                                                    | date: 'd. MMMM y' }} {{selectedMessage[0].created_at
                                                                    | date: 'HH:mm': 'GMT+2' }}</div>
                                                            </div>
                                                        </div>
                                                        <div class="chat-right">
                                                            <ul>
                                                                <li><button type="button"
                                                                        (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id, selectedMessage[0].group.id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.reply}}"><i
                                                                            class="fa fa-reply"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        data-tooltip alt="Starred"><i
                                                                            class="fa fa-star-o"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.trash}}"><i
                                                                            class="fa fa-trash"
                                                                            aria-hidden="true"></i></button></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-inner-content">
                                                    <h2>{{selectedMessage[0].subject}}</h2>
                                                    <p>{{selectedMessage[0].content}}</p>
                                                    <div class="view-attachments"
                                                        *ngIf="stringifiedData(selectedMessage[0].attachments).length > 0">
                                                        <div
                                                            *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                            </a>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                                {{attachment.split('/').pop()}}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chat-form" *ngIf="isReplyMsgForm">
                                            <h4 class="reply-heading" id="reply-heading"></h4>
                                            <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                                <div class="multipl-participent-reply reply-users"
                                                    *ngIf="singleParticipent">
                                                    <div class="more-toggle"><i aria-hidden="true"
                                                            class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                    </div>
                                                    <div class="bottom-reply-to">
                                                        <div>
                                                            <Span>{{language.create_message.all_receipient}}: </Span>
                                                            <span *ngFor='let touser of receipientUsers'>
                                                                <span class="to-username"
                                                                    *ngIf="touser.groupusers.length > 0"
                                                                    tooltip="{{touser.groupusers[0].email}}"
                                                                    placement="bottom"
                                                                    delay="500">"{{touser.groupusers[0].firstname}}
                                                                    {{touser.groupusers[0].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="message_upload news_pic_upload">
                                                    <div class="message-upload-list" style="display: none;">
                                                        <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                        <label class="preview_txt" style="display: none;"></label>
                                                    </div>
                                                </div>
                                                <div class="chat-form-inner">
                                                    <div class="chat-text-area">
                                                        <textarea type="text" formControlName="content"
                                                            placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                        <input type="hidden" id="replyMsgType" value="" />
                                                        <input type="hidden" id="replyToMsgId" value="" />
                                                        <label class="text-danger"
                                                            *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                    </div>
                                                    <div class="chat-btn-group">
                                                        <div class="chat_upload_btn"><input type="file"
                                                                (change)="uploadFile($event)" id="add_image">
                                                            <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                    src="assets/img/attach.svg"></Span>
                                                        </div>
                                                        <div class="chat_sent_btn"><button type="submit"><i
                                                                    class="nc-icon nc-minimal-right"></i></button></div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupStarred">

                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupStarredMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                        <div class="chat-content">
                                            <div class="inner-chat">
                                                <div class="chat-top-area">
                                                    <div class="chat-header">
                                                        <div class="chat-left">
                                                            <div class="chat-user-img-main">
                                                                <div class="chat-user-img-in">
                                                                    <div class="chat-user-img-in"
                                                                        *ngIf="selectedMessage[0].group">
                                                                        <img onContextMenu="return false;" alt="" loading="lazy"
                                                                            [src]=" selectedMessage[0].group.image ?  selectedMessage[0].group.image : 'assets/img/defaultProfile.jpeg'">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="user-detail-info">
                                                                <div class="chat-user-name" *ngIf="selectedMessage && selectedMessage[0]?.user" 
                                                                    tooltip="{{selectedMessage[0].user.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{selectedMessage[0].user.firstName}}
                                                                    {{selectedMessage[0].user.lastName}}"</div>
                                                                <div class="group_name"
                                                                    *ngIf="selectedMessage[0].group.id"> <a
                                                                        routerLink="/group-detail/{{selectedMessage[0].group.id}}">({{selectedMessage[0].group.name}})</a>
                                                                </div>
                                                                <div class="reply-date">{{selectedMessage[0].created_at | date: 'd. MMMM y' }} {{selectedMessage[0].created_at  | date: 'HH:mm': 'GMT+2' }}</div>
                                                            </div>
                                                        </div>
                                                        <div class="chat-right">
                                                            <ul>
                                                                <li><button type="button"
                                                                        (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id, selectedMessage[0].group.id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.reply}}"><i
                                                                            class="fa fa-reply"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="unmarkedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="Starred fill"><i class="fa fa-star"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.trash}}"><i
                                                                            class="fa fa-trash"
                                                                            aria-hidden="true"></i></button></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-inner-content">
                                                    <h2>{{selectedMessage[0].subject}}</h2>
                                                    <p>{{selectedMessage[0].content}}</p>
                                                    <div class="view-attachments"
                                                        *ngIf="stringifiedData(selectedMessage[0].attachments).length > 0">
                                                        <div
                                                            *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                            </a>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                                {{attachment.split('/').pop()}}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chat-form" *ngIf="isReplyMsgForm">
                                            <h4 class="reply-heading" id="reply-heading"></h4>
                                            <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                                <div class="multipl-participent-reply reply-users"
                                                    *ngIf="singleParticipent">
                                                    <div class="more-toggle"><i aria-hidden="true"
                                                            class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                    </div>
                                                    <div class="bottom-reply-to">
                                                        <div>
                                                            <Span>{{language.create_message.all_receipient}}: </Span>
                                                            <span *ngFor='let touser of receipientUsers'>
                                                                <span class="to-username"
                                                                    *ngIf="touser.groupusers.length > 0"
                                                                    tooltip="{{touser.groupusers[0].email}}"
                                                                    placement="bottom"
                                                                    delay="500">"{{touser.groupusers[0].firstname}}
                                                                    {{touser.groupusers[0].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="message_upload news_pic_upload">
                                                    <div class="message-upload-list" style="display: none;">
                                                        <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                        <label class="preview_txt" style="display: none;"></label>
                                                    </div>
                                                </div>
                                                <div class="chat-form-inner">
                                                    <div class="chat-text-area">
                                                        <textarea type="text" formControlName="content"
                                                            placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                        <input type="hidden" id="replyMsgType" value="" />
                                                        <input type="hidden" id="replyToMsgId" value="" />
                                                        <label class="text-danger"
                                                            *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                    </div>
                                                    <div class="chat-btn-group">
                                                        <div class="chat_upload_btn"><input type="file"
                                                                (change)="uploadFile($event)" id="add_image">
                                                            <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                    src="assets/img/attach.svg"></Span>
                                                        </div>
                                                        <div class="chat_sent_btn"><button type="submit"><i
                                                                    class="nc-icon nc-minimal-right"></i></button></div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupSent">
                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupSentMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                        <div class="chat-content">
                                            <div class="inner-chat">
                                                <div class="chat-top-area">
                                                    <div class="chat-header">
                                                        <div class="chat-left">
                                                            <div class="chat-user-img-main">
                                                                <div class="chat-user-img-in">
                                                                    <div class="chat-user-img-in"
                                                                        *ngIf="selectedMessage[0].group">
                                                                        <img onContextMenu="return false;" alt="" loading="lazy"
                                                                            [src]=" selectedMessage[0].group.image ?  selectedMessage[0].group.image : 'assets/img/defaultProfile.jpeg'">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="user-detail-info">
                                                                <div class="chat-user-name" *ngIf="selectedMessage && selectedMessage[0]?.user" 
                                                                    tooltip="{{selectedMessage[0].user.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{selectedMessage[0].user.firstName}}
                                                                    {{selectedMessage[0].user.lastName}}"</div>
                                                                <div class="group_name"
                                                                    *ngIf="selectedMessage[0].group.id"> <a
                                                                        routerLink="/group-detail/{{selectedMessage[0].group.id}}">({{selectedMessage[0].group.name}})</a>
                                                                </div>
                                                                <div class="reply-date">{{selectedMessage[0].created_at
                                                                    | date: 'd. MMMM y' }} {{selectedMessage[0].created_at
                                                                    | date: 'HH:mm': 'GMT+2' }}</div>
                                                            </div>
                                                        </div>
                                                        <div class="chat-right">
                                                            <ul>
                                                                <li><button type="button"
                                                                        (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id, selectedMessage[0].group.id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.reply}}"><i
                                                                            class="fa fa-reply"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        data-tooltip alt="Starred"><i
                                                                            class="fa fa-star-o"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.trash}}"><i
                                                                            class="fa fa-trash"
                                                                            aria-hidden="true"></i></button></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-inner-content">
                                                    <h2>{{selectedMessage[0].subject}}</h2>
                                                    <p>{{selectedMessage[0].content}}</p>
                                                    <div class="view-attachments"
                                                        *ngIf="stringifiedData(selectedMessage[0].attachments).length > 0">
                                                        <div
                                                            *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                            </a>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                                {{attachment.split('/').pop()}}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chat-form" *ngIf="isReplyMsgForm">
                                            <h4 class="reply-heading" id="reply-heading"></h4>
                                            <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                                <div class="multipl-participent-reply reply-users"
                                                    *ngIf="singleParticipent">
                                                    <div class="more-toggle"><i aria-hidden="true"
                                                            class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                    </div>
                                                    <div class="bottom-reply-to">
                                                        <div>
                                                            <Span>{{language.create_message.all_receipient}}: </Span>
                                                            <span *ngFor='let touser of receipientUsers'>
                                                                <span class="to-username"
                                                                    *ngIf="touser.groupusers.length > 0"
                                                                    tooltip="{{touser.groupusers[0].email}}"
                                                                    placement="bottom"
                                                                    delay="500">"{{touser.groupusers[0].firstname}}
                                                                    {{touser.groupusers[0].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="message_upload news_pic_upload">
                                                    <div class="message-upload-list" style="display: none;">
                                                        <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                        <label class="preview_txt" style="display: none;"></label>
                                                    </div>
                                                </div>
                                                <div class="chat-form-inner">
                                                    <div class="chat-text-area">
                                                        <textarea type="text" formControlName="content"
                                                            placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                        <input type="hidden" id="replyMsgType" value="" />
                                                        <input type="hidden" id="replyToMsgId" value="" />
                                                        <label class="text-danger"
                                                            *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                    </div>
                                                    <div class="chat-btn-group">
                                                        <div class="chat_upload_btn"><input type="file"
                                                                (change)="uploadFile($event)" id="add_image">
                                                            <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                    src="assets/img/attach.svg"></Span>
                                                        </div>
                                                        <div class="chat_sent_btn"><button type="submit"><i
                                                                    class="nc-icon nc-minimal-right"></i></button></div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupDrafts">

                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupDraftMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                        <div class="chat-form">
                                            <div class="chat-content">
                                                <div class="inner-chat">
                                                    <div class="chat-top-area">
                                                        <div class="chat-header">
                                                            <div class="chat-left"></div>
                                                            <div class="chat-right">
                                                                <ul>
                                                                    <li><button type="button"
                                                                            (click)="deleteDraftMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                            placement="bottom" delay="500"
                                                                            tooltip="{{language.community_messages.delete}}"><i
                                                                                class="fa fa-trash"
                                                                                aria-hidden="true"></i></button></li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card draft_main">
                                                <form [formGroup]="messageForm" (ngSubmit)='messageProcess()'>
                                                    <div class="card-body">
                                                        <div class="profile_details">
                                                            <!-- <div class="alert alert-danger" *ngIf="responseMessage">
                                                                {{responseMessage}}</div> -->
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <div class="news-dropdown">
                                                                        <div class="multi_dropdown_main">
                                                                            <label>{{language.create_message.participantsto}}</label>
                                                                            <ng-multiselect-dropdown
                                                                                formControlName="kind_id"
                                                                                [placeholder]="language.create_message.participantsto"
                                                                                [settings]="groupDropdownSettings"
                                                                                [data]="groups"
                                                                                (onSelect)="onKindIdSelect($event)"
                                                                                (onDeSelect)="onKindIdDeSelect($event)">
                                                                            </ng-multiselect-dropdown>
                                                                            <label class="text-danger"
                                                                                *ngIf="messageSubmitted && messageForm.controls['kind_id'].errors">{{language.error_message.common_required}}</label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12">
                                                                    <div class="event_field">
                                                                        <label>{{language.create_message.subject}}</label>
                                                                        <input type="text" formControlName="subject"
                                                                            placeholder="{{language.create_message.subject_placeholder}}">
                                                                        <label class="text-danger"
                                                                            *ngIf="messageSubmitted && messageForm.controls['subject'].errors">{{language.error_message.common_required}}</label>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12">
                                                                    <div class="event_field task_area_field">
                                                                        <label>{{language.create_message.content}}</label>
                                                                        <textarea formControlName="content"
                                                                            placeholder="{{language.create_message.content_placeholder}}"></textarea>
                                                                        <label class="text-danger"
                                                                            *ngIf="messageSubmitted && messageForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="view-attachments"
                                                            *ngIf="stringifiedData(selectedMessage[0].attachments).length > 0">
                                                            <div
                                                                *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                                <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                                    href="{{attachment}}">
                                                                    <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                                </a>
                                                                <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                                    href="{{attachment}}">
                                                                    <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                                    {{attachment.split('/').pop()}}
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class="event_upload news_pic_upload">
                                                            <div class="message-upload-list" style="display: none;">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                                <label class="preview_txt"
                                                                    style="display: none;"></label>
                                                            </div>
                                                        </div>
                                                        <div class="profile_sub_btn message_sub_btn">
                                                            <button type="submit"
                                                                class="save_btn">{{language.create_message.send}}</button>
                                                            <div class="message_upload">
                                                                <input type="file" (change)="uploadDraftFile($event)"
                                                                    id="add_image">
                                                                <span class="message_upload_overlay">
                                                                    <div class="upload_label">
                                                                        <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/attach.svg">
                                                                        <div class="up_text">
                                                                            {{language.create_message.add_file}}<br><span>(Max
                                                                                20Mb)</span></div>
                                                                    </div>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupAllMail">
                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupAllMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                        <div class="chat-content">
                                            <div class="inner-chat">
                                                <div class="chat-top-area">
                                                    <div class="chat-header">
                                                        <div class="chat-left">
                                                            <div class="chat-user-img-main">
                                                                <div class="chat-user-img-in">
                                                                    <div class="chat-user-img-in"
                                                                        *ngIf="selectedMessage[0].group">
                                                                        <img onContextMenu="return false;" alt="" loading="lazy"
                                                                            [src]=" selectedMessage[0].group.image ?  selectedMessage[0].group.image : 'assets/img/defaultProfile.jpeg'">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="user-detail-info">
                                                                <div class="chat-user-name" *ngIf="selectedMessage && selectedMessage[0]?.user" 
                                                                    tooltip="{{selectedMessage[0].user.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{selectedMessage[0].user.firstName}}
                                                                    {{selectedMessage[0].user.lastName}}"</div>
                                                                <div class="group_name"
                                                                    *ngIf="selectedMessage[0].group.id"> <a
                                                                        routerLink="/group-detail/{{selectedMessage[0].group.id}}">({{selectedMessage[0].group.name}})</a>
                                                                </div>
                                                                <div class="reply-date">{{selectedMessage[0].created_at | date: 'd. MMMM y' }} {{selectedMessage[0].created_at  | date: 'HH:mm': 'GMT+2' }}</div>
                                                            </div>
                                                        </div>
                                                        <div class="chat-right">
                                                            <ul>
                                                                <li><button type="button"
                                                                        (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id, selectedMessage[0].group.id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.reply}}"><i
                                                                            class="fa fa-reply"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        data-tooltip alt="Starred"><i
                                                                            class="fa fa-star-o"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.trash}}"><i
                                                                            class="fa fa-trash"
                                                                            aria-hidden="true"></i></button></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-inner-content">
                                                    <h2>{{selectedMessage[0].subject}}</h2>
                                                    <p>{{selectedMessage[0].content}}</p>
                                                    <div class="view-attachments"
                                                        *ngIf="stringifiedData(selectedMessage[0].attachments).length > 0">
                                                        <div
                                                            *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                            </a>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                                {{attachment.split('/').pop()}}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chat-form" *ngIf="isReplyMsgForm">
                                            <h4 class="reply-heading" id="reply-heading"></h4>
                                            <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                                <div class="multipl-participent-reply reply-users"
                                                    *ngIf="singleParticipent">
                                                    <div class="more-toggle"><i aria-hidden="true"
                                                            class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                    </div>
                                                    <div class="bottom-reply-to">
                                                        <div>
                                                            <Span>{{language.create_message.all_receipient}}: </Span>
                                                            <span *ngFor='let touser of receipientUsers'>
                                                                <span class="to-username"
                                                                    *ngIf="touser.groupusers.length > 0"
                                                                    tooltip="{{touser.groupusers[0].email}}"
                                                                    placement="bottom"
                                                                    delay="500">"{{touser.groupusers[0].firstname}}
                                                                    {{touser.groupusers[0].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="message_upload news_pic_upload">
                                                    <div class="message-upload-list" style="display: none;">
                                                        <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                        <label class="preview_txt" style="display: none;"></label>
                                                    </div>
                                                </div>
                                                <div class="chat-form-inner">
                                                    <div class="chat-text-area">
                                                        <textarea type="text" formControlName="content"
                                                            placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                        <input type="hidden" id="replyMsgType" value="" />
                                                        <input type="hidden" id="replyToMsgId" value="" />
                                                        <label class="text-danger"
                                                            *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                    </div>
                                                    <div class="chat-btn-group">
                                                        <div class="chat_upload_btn"><input type="file"  (change)="uploadFile($event)" id="add_image">
                                                            <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"  src="assets/img/attach.svg"></Span>
                                                        </div>
                                                        <div class="chat_sent_btn"><button type="submit"><i class="nc-icon nc-minimal-right"></i></button></div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="groupTrash">
                                <div *ngIf="groupMessage && groupMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.groupTrashMessages}}</span>
                                </div>
                                <ng-container *ngIf="groupMessage && groupMessage.length > 0">
                                    <div class="chat_messager-widget">
                                        <div class="chat-sidebar">
                                            <div class="chat-search">
                                                <form>
                                                    <div class="input-group no-border">
                                                        <div class="input-group-append">
                                                            <div class="input-group-text">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/Search.svg">
                                                            </div>
                                                        </div>
                                                        <input type="text" value="" class="form-control"
                                                            placeholder="{{language.community_messages.search}}...">
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                        <div class="chat-content">
                                            <div class="inner-chat">
                                                <div class="chat-top-area">
                                                    <div class="chat-header">
                                                        <div class="chat-left">
                                                            <div class="chat-user-img-main">
                                                                <div class="chat-user-img-in">
                                                                    <div class="chat-user-img-in"
                                                                        *ngIf="selectedMessage[0].group">
                                                                        <img onContextMenu="return false;" alt="" loading="lazy"
                                                                            [src]=" selectedMessage[0].group.image ?  selectedMessage[0].group.image : 'assets/img/defaultProfile.jpeg'">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="user-detail-info">
                                                                <div class="chat-user-name" *ngIf="selectedMessage && selectedMessage[0]?.user" 
                                                                    tooltip="{{selectedMessage[0].user.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{selectedMessage[0].user.firstName}}
                                                                    {{selectedMessage[0].user.lastName}}"</div>
                                                                <div class="group_name"
                                                                    *ngIf="selectedMessage[0].group.id"> <a
                                                                        routerLink="/group-detail/{{selectedMessage[0].group.id}}">({{selectedMessage[0].group.name}})</a>
                                                                </div>
                                                                <div class="reply-date">{{selectedMessage[0].created_at | date: 'd. MMMM y' }} {{selectedMessage[0].created_at | date: 'HH:mm': 'GMT+2' }}</div>
                                                            </div>
                                                        </div>
                                                        <div class="chat-right">
                                                            <ul>
                                                                <li><button type="button"
                                                                        (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        data-tooltip alt="Starred"><i
                                                                            class="fa fa-star-o"
                                                                            aria-hidden="true"></i></button></li>
                                                                <li><button type="button"
                                                                        (click)="deleteMessagesPermanently(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        placement="bottom" delay="500"
                                                                        tooltip="{{language.community_messages.delete}}"><i
                                                                            class="fa fa-trash"
                                                                            aria-hidden="true"></i></button></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="chat-inner-content">
                                                    <h2>{{selectedMessage[0].subject}}</h2>
                                                    <p>{{selectedMessage[0].content}}</p>
                                                    <div class="view-attachments"
                                                        *ngIf="stringifiedData(selectedMessage[0].attachments).length > 0">
                                                        <div
                                                            *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                            </a>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                                {{attachment.split('/').pop()}}
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chat-form" *ngIf="isReplyMsgForm">
                                            <h4 class="reply-heading" id="reply-heading"></h4>
                                            <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                                <div class="chat-form-inner">
                                                    <div class="message_upload news_pic_upload">
                                                        <div class="message-upload-list" style="display: none;">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                            <label class="preview_txt" style="display: none;"></label>
                                                        </div>
                                                    </div>
                                                    <div class="chat-text-area">
                                                        <textarea type="text" formControlName="content"
                                                            placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                        <input type="hidden" id="replyMsgType" value="" />
                                                        <input type="hidden" id="replyToMsgId" value="" />
                                                        <label class="text-danger"
                                                            *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                    </div>
                                                    <div class="chat-btn-group">
                                                        <div class="chat_upload_btn"><input type="file"
                                                                (change)="uploadFile($event)" id="add_image">
                                                            <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                    src="assets/img/attach.svg"></Span>
                                                        </div>
                                                        <div class="chat_sent_btn"><button type="submit"><i
                                                                    class="nc-icon nc-minimal-right"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
