<div class="card " *ngIf="messageData">
    <div class="card-body ">
        <div class="row">
            <button class="back-message-btn" type="button" (click)="back()"><svg xmlns="http://www.w3.org/2000/svg" width="47" height="47"
                viewBox="0 0 47 47" fill="none">
                <rect x="2" width="43" height="43" rx="9" fill="#F8F8F8" />
                <g filter="url(#filter0_di_363_248)">
                    <rect x="4.38892" y="2.38892" width="38.2222" height="38.2222" rx="7"
                        fill="url(#paint0_linear_363_248)" />
                </g>
                <g filter="url(#filter1_i_363_248)">
                    <path
                        d="M21.3152 21.4208C21.3808 21.4208 21.4464 21.4208 21.5116 21.4208C24.7779 21.4208 28.0448 21.4203 31.3111 21.4213C32.0898 21.4213 32.6997 21.862 32.8883 22.5552C33.1653 23.5719 32.4391 24.5253 31.3695 24.5375C30.5753 24.5462 29.7812 24.5394 28.9875 24.5394C26.497 24.5394 24.0064 24.5394 21.5159 24.5394C21.4498 24.5394 21.3837 24.5394 21.307 24.5394C21.3147 24.6207 21.3798 24.6513 21.4213 24.6931C22.2917 25.5756 23.1684 26.4522 24.0344 27.3385C24.5386 27.8541 24.6351 28.5911 24.2998 29.1992C23.8019 30.102 22.6106 30.2762 21.8676 29.5436C21.2221 28.9068 20.5895 28.2564 19.9517 27.6119C18.8116 26.4604 17.6715 25.309 16.5314 24.1571C15.8237 23.442 15.8227 22.5192 16.5295 21.8051C18.2823 20.0339 20.0337 18.2622 21.788 16.4935C22.5552 15.72 23.7666 15.8781 24.2699 16.8111C24.6023 17.4275 24.4899 18.1625 23.9756 18.684C23.1307 19.5411 22.2835 20.3953 21.4358 21.2491C21.3905 21.2948 21.3335 21.3293 21.2819 21.3692C21.2935 21.3862 21.3041 21.4037 21.3152 21.4208Z"
                        fill="#569AFF" />
                </g>
                <defs>
                    <filter id="filter0_di_363_248" x="0.388916" y="0.388916" width="46.2222" height="46.2222"
                        filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                        <feFlood flood-opacity="0" result="BackgroundImageFix" />
                        <feColorMatrix in="SourceAlpha" type="matrix"  values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
                        <feOffset dy="2" />
                        <feGaussianBlur stdDeviation="2" />
                        <feComposite in2="hardAlpha" operator="out" />
                        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0" />
                        <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_363_248" />
                        <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_363_248" result="shape" />
                        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
                        <feOffset dy="1" />
                        <feGaussianBlur stdDeviation="0.5" />
                        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1" />
                        <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0" />
                        <feBlend mode="normal" in2="shape" result="effect2_innerShadow_363_248" />
                    </filter>
                    <filter id="filter1_i_363_248" x="16" y="16" width="16.9475" height="15"
                        filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                        <feFlood flood-opacity="0" result="BackgroundImageFix" />
                        <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
                        <feOffset dy="1" />
                        <feGaussianBlur stdDeviation="0.5" />
                        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1" />
                        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0" />
                        <feBlend mode="normal" in2="shape" result="effect1_innerShadow_363_248" />
                    </filter>
                    <linearGradient id="paint0_linear_363_248" x1="23.5" y1="2.38892" x2="23.5" y2="40.6111"
                        gradientUnits="userSpaceOnUse">
                        <stop stop-color="#F4F4F4" />
                        <stop offset="1" stop-color="#F8F8F8" />
                    </linearGradient>
                </defs>
            </svg></button>
            <div class="col-lg-12 col-md-12 col-sm-12">
                <div class="tab-content">
                    <div class="tab-pane active">
                        <ng-container>
                            <ng-container *ngIf="personalInbox">
                                <!-- <div class="error alert alert-danger" *ngIf="responseMessage">{{responseMessage}}</div> -->
                                <div *ngIf="selectedMessage && selectedMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy" src="../assets/img/no_record_img.png"><br> -->
                                    <span>{{language.community_messages.personalMessages}}</span>
                                </div>
                                <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                    <div class="chat-content">
                                        <div class="inner-chat">
                                            <div class="chat-top-area">
                                                <div class="chat-header">
                                                    <div class="chat-left">
                                                        <div class="chat-user-img-main"
                                                            *ngIf="selectedMessage[0] && selectedMessage[0].user">
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image == null || selectedMessage[0].user.image == '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/defaultProfile.jpeg">
                                                            </div>
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image != null || selectedMessage[0].user.image != '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" [src]="selectedMessage[0].user.image">
                                                            </div>
                                                        </div>
                                                        <div class="user-detail-info"
                                                            *ngIf="selectedMessage && selectedMessage[0].user">
                                                            <div class="chat-user-name"
                                                                tooltip="{{selectedMessage[0].user.email}}"
                                                                placement="top" delay="500">
                                                                "{{selectedMessage[0].user.firstName}}
                                                                {{selectedMessage[0].user.lastName}}"
                                                            </div>
                                                            <div class="reply-date">{{selectedMessage[0].created_at
                                                                | date: 'd. MMMM y' }} {{selectedMessage[0].created_at
                                                                | date: 'HH:mm': 'GMT+2' }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="chat-right" *ngIf="selectedMessage[0]">
                                                        <ul>
                                                            <li *ngIf="selectedMessage">
                                                                <button type="button"
                                                                    (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.reply}}"
                                                                    placement="bottom" delay="500">
                                                                    <i class="fa fa-reply" aria-hidden="true"></i>
                                                                </button>
                                                            </li>
                                                            <li
                                                                *ngIf="selectedMessage[0] && (selectedMessage[0].to || selectedMessage[0].cc)">
                                                                <button type="button"
                                                                    *ngIf="selectedMessage[0].to.length > 1 || selectedMessage[0].cc.length > 0"
                                                                    (click)="replayToAllMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.replyToAll}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-reply-all"
                                                                        aria-hidden="true"></i>
                                                                </button>
                                                            </li>
                                                            <li><button type="button"
                                                                    (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    data-tooltip alt="Starred"><i
                                                                        class="fa fa-star-o"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.trash}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-trash"
                                                                        aria-hidden="true"></i>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="reply-users">
                                                    <div class="more-toggle">
                                                        <i class="fa fa-caret-square-o-down" aria-hidden="true"
                                                            (click)="onShow()"></i>
                                                    </div>
                                                    <div class="cc-to-main">
                                                        <div class="chat-user-name">
                                                            {{language.create_message.participantsto}}-
                                                            <span *ngFor='let touserr of selectedMessage[0].to'>
                                                                <span *ngIf="touserr && alluserDetails[touserr]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails[touserr].email}}"
                                                                    placement="bottom" delay="500">
                                                                    "{{alluserDetails[touserr].firstname}}
                                                                    {{alluserDetails[touserr].lastname}}",
                                                                </span>
                                                            </span>
                                                            <span *ngFor='let touser of selectedMessage[0].to'>
                                                                <span *ngIf="touser && alluserDetails[touserr]"
                                                                    class="to-username" placement="bottom"
                                                                    delay="500">
                                                                    "{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",
                                                                </span>
                                                            </span>
                                                        </div>
                                                        <div class="chat-user-name"
                                                            *ngIf="selectedMessage[0] && selectedMessage[0].cc && selectedMessage[0].cc.length > 0"> cc :-
                                                            <span *ngFor='let touser of selectedMessage[0].cc'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="bottom"
                                                                    delay="500">"{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-inner-content">
                                                <h2>{{selectedMessage[0].subject}}</h2>
                                                <p>{{selectedMessage[0].content}}</p>
                                                <div class="view-attachments"
                                                    *ngIf="stringifiedData(selectedMessage[0].attachments) && stringifiedData(selectedMessage[0].attachments).length > 0">
                                                    <div
                                                        *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                        </a>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                            {{attachment.split('/').pop()}}
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-form" *ngIf="isReplyMsgForm">
                                        <h4 class="reply-heading" id="reply-heading"></h4>
                                        <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                            <div class="single-participent-reply reply-users"
                                                *ngIf="singleParticipent">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span>
                                                            <span class="to-username"
                                                                tooltip="{{alluserDetails[selectedMessage[0].sender_id].email}}"
                                                                placement="bottom"
                                                                delay="500">{{alluserDetails[selectedMessage[0].sender_id].firstname}}
                                                                {{alluserDetails[selectedMessage[0].sender_id].lastname}}</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="multipl-participent-reply reply-users"
                                                *ngIf="multipleParticipent && selectedMessage[0].to.length > 0">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].to'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="to-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="bottom"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="selectedMessage[0].cc.length > 0">
                                                        <Span>Cc: </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].cc'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="cc-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="bottom"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="message_upload news_pic_upload">
                                                <div class="message-upload-list" style="display: none;">
                                                    <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                    <label class="preview_txt" style="display: none;"></label>
                                                </div>
                                            </div>
                                            <div class="chat-form-inner">
                                                <div class="chat-text-area">
                                                    <textarea type="text" formControlName="content"
                                                        placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                    <input type="hidden" id="replyMsgType" value="" />
                                                    <input type="hidden" id="replyToMsgId" value="" />
                                                    <label class="text-danger"
                                                        *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                </div>
                                                <div class="chat-btn-group">
                                                    <div class="chat_upload_btn"><input type="file"
                                                            (change)="uploadFile($event)" id="add_image">
                                                        <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                src="assets/img/attach.svg"></Span>
                                                    </div>
                                                    <div class="chat_sent_btn"><button type="submit"><i
                                                                class="nc-icon nc-minimal-right"></i></button></div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="personalStarred">
                                <!-- <div class="error alert alert-danger" *ngIf="responseMessage">{{responseMessage}}</div> -->
                                <div *ngIf="selectedMessage && selectedMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy" src="../assets/img/no_record_img.png"><br> -->
                                    <span>{{language.community_messages.personalStarredMessages}}</span>
                                </div>
                                <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                    <div class="chat-content">
                                        <div class="inner-chat">
                                            <div class="chat-top-area">
                                                <div class="chat-header">
                                                    <div class="chat-left">
                                                        <div class="chat-user-img-main"
                                                            *ngIf="selectedMessage[0] && selectedMessage[0].user">
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image == null || selectedMessage[0].user.image == '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/defaultProfile.jpeg">
                                                            </div>
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image != null || selectedMessage[0].user.image != '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" [src]="selectedMessage[0].user.image">
                                                            </div>
                                                        </div>
                                                        <div class="user-detail-info ">
                                                            <div class="chat-user-name"
                                                                tooltip="{{selectedMessage[0].user.email}}"
                                                                placement="top" delay="500">
                                                                "{{selectedMessage[0].user.firstName}}
                                                                {{selectedMessage[0].user.lastName}}"
                                                            </div>
                                                            <div class="reply-date">{{selectedMessage[0].created_at
                                                                | date: 'd. MMMM y' }} {{selectedMessage[0].created_at
                                                                | date: 'HH:mm': 'GMT+2' }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="chat-right">
                                                        <ul>
                                                            <li><button type="button"
                                                                    (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.reply}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-reply"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    *ngIf="selectedMessage[0].to.length > 1 || selectedMessage[0].cc.length > 0"
                                                                    (click)="replayToAllMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.replyToAll}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-reply-all"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    (click)="unmarkedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    data-tooltip alt="Starred"><i class="fa fa-star"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.trash}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-trash"
                                                                        aria-hidden="true"></i></button></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="reply-users">
                                                    <div class="more-toggle">
                                                        <i class="fa fa-caret-square-o-down" aria-hidden="true"
                                                            (click)="onShow()"></i>
                                                    </div>
                                                    <div class="cc-to-main">
                                                        <div class="chat-user-name">
                                                            {{language.create_message.participantsto}}-
                                                            <span *ngFor='let touser of selectedMessage[0].to'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                        <div class="chat-user-name"
                                                            *ngIf="selectedMessage[0].cc.length > 0">cc :-
                                                            <span *ngFor='let touser of selectedMessage[0].cc'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top"
                                                                    delay="500">"{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-inner-content">
                                                <h2>{{selectedMessage[0].subject}}</h2>
                                                <p>{{selectedMessage[0].content}}</p>
                                                <div class="view-attachments"
                                                    *ngIf="stringifiedData(selectedMessage[0].attachments) && stringifiedData(selectedMessage[0].attachments).length > 0">
                                                    <div
                                                        *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                        </a>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                            {{attachment.split('/').pop()}}
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-form" *ngIf="isReplyMsgForm">
                                        <h4 class="reply-heading" id="reply-heading"></h4>
                                        <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                            <div class="single-participent-reply reply-users"
                                                *ngIf="singleParticipent">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span>
                                                            <span class="to-username"
                                                                tooltip="{{alluserDetails[selectedMessage[0].sender_id].email}}"
                                                                placement="top"
                                                                delay="500">{{alluserDetails[selectedMessage[0].sender_id].firstname}}
                                                                {{alluserDetails[selectedMessage[0].sender_id].lastname}}</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="multipl-participent-reply reply-users"
                                                *ngIf="multipleParticipent && selectedMessage[0].to.length > 0">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].to'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="to-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="top"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="selectedMessage[0].cc.length > 0">
                                                        <Span>Cc: </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].cc'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="cc-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="top"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-form-inner">
                                                <div class="message_upload news_pic_upload">
                                                    <div class="message-upload-list" style="display: none;">
                                                        <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                        <label class="preview_txt" style="display: none;"></label>
                                                    </div>
                                                </div>
                                                <div class="chat-text-area">
                                                    <textarea type="text" formControlName="content"
                                                        placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                    <input type="hidden" id="replyMsgType" value="" />
                                                    <input type="hidden" id="replyToMsgId" value="" />
                                                    <label class="text-danger"
                                                        *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                </div>
                                                <div class="chat-btn-group">
                                                    <div class="chat_upload_btn"><input type="file"
                                                            (change)="uploadFile($event)" id="add_image">
                                                        <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                src="assets/img/attach.svg"></Span>
                                                    </div>
                                                    <div class="chat_sent_btn"><button type="submit"><i
                                                                class="nc-icon nc-minimal-right"></i></button></div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="personalSent">
                                <!-- <div class="error alert alert-danger" *ngIf="responseMessage">{{responseMessage}}</div> -->
                                <div *ngIf="selectedMessage && selectedMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.personalSentMessages}}</span>
                                </div>
                                <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                    <div class="chat-content">
                                        <div class="inner-chat">
                                            <div class="chat-top-area">
                                                <div class="chat-header">
                                                    <div class="chat-left" *ngIf="selectedMessage[0].user">
                                                        <div class="chat-user-img-main">
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image == null || selectedMessage[0].user.image == '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/defaultProfile.jpeg">
                                                            </div>
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image != null || selectedMessage[0].user.image != '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" [src]="selectedMessage[0].user.image">
                                                            </div>
                                                        </div>
                                                        <div class="user-detail-info ">
                                                            <div class="chat-user-name"
                                                                tooltip="{{selectedMessage[0].user.email}}"
                                                                placement="top" delay="500">
                                                                "{{selectedMessage[0].user.firstName}}
                                                                {{selectedMessage[0].user.lastName}}"
                                                            </div>
                                                            <div class="reply-date">{{selectedMessage[0].created_at | date: 'd. MMMM y' }} {{selectedMessage[0].created_at | date: 'HH:mm': 'GMT+2' }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="chat-right">
                                                        <ul>
                                                            <li><button type="button"
                                                                    (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.reply}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-reply"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    *ngIf="selectedMessage[0].to.length > 1 || selectedMessage[0].cc.length > 0"
                                                                    (click)="replayToAllMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.replyToAll}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-reply-all"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    data-tooltip alt="Starred"><i
                                                                        class="fa fa-star-o"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.trash}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-trash"
                                                                        aria-hidden="true"></i></button></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="reply-users">
                                                    <div class="more-toggle">
                                                        <i class="fa fa-caret-square-o-down" aria-hidden="true"
                                                            (click)="onShow()"></i>
                                                    </div>
                                                    <div class="cc-to-main">
                                                        <div class="chat-user-name">
                                                            {{language.create_message.participantsto}}-
                                                            <span *ngFor='let touser of selectedMessage[0].to'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                        <div class="chat-user-name"
                                                            *ngIf="selectedMessage[0].cc.length > 0">cc :-
                                                            <span *ngFor='let touser of selectedMessage[0].cc'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top"
                                                                    delay="500">"{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-inner-content">
                                                <h2>{{selectedMessage[0].subject}}</h2>
                                                <p>{{selectedMessage[0].content}}</p>
                                                <div class="view-attachments"
                                                    *ngIf="stringifiedData(selectedMessage[0].attachments) && stringifiedData(selectedMessage[0].attachments).length > 0">
                                                    <div
                                                        *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                        </a>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                            {{attachment.split('/').pop()}}
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-form" *ngIf="isReplyMsgForm">
                                        <h4 class="reply-heading" id="reply-heading"></h4>
                                        <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                            <div class="single-participent-reply reply-users"
                                                *ngIf="singleParticipent">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span>
                                                            <span class="to-username"
                                                                tooltip="{{alluserDetails[selectedMessage[0].sender_id].email}}"
                                                                placement="top"
                                                                delay="500">{{alluserDetails[selectedMessage[0].sender_id].firstname}}
                                                                {{alluserDetails[selectedMessage[0].sender_id].lastname}}</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="multipl-participent-reply reply-users"
                                                *ngIf="multipleParticipent && selectedMessage[0].to.length > 0">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].to'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="to-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="top"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="selectedMessage[0].cc.length > 0">
                                                        <Span>Cc: </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].cc'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="cc-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="top"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-form-inner">
                                                <div class="message_upload news_pic_upload">
                                                    <div class="message-upload-list" style="display: none;">
                                                        <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                        <label class="preview_txt" style="display: none;"></label>
                                                    </div>
                                                </div>
                                                <div class="chat-text-area">
                                                    <textarea type="text" formControlName="content"
                                                        placeholder="{{language.create_message.compose_replay}}"></textarea>
                                                    <input type="hidden" id="replyMsgType" value="" />
                                                    <input type="hidden" id="replyToMsgId" value="" />
                                                    <label class="text-danger"
                                                        *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                </div>
                                                <div class="chat-btn-group">
                                                    <div class="chat_upload_btn"><input type="file"
                                                            (change)="uploadFile($event)" id="add_image">
                                                        <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                src="assets/img/attach.svg"></Span>
                                                    </div>
                                                    <div class="chat_sent_btn"><button type="submit"><i
                                                                class="nc-icon nc-minimal-right"></i></button></div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="personalDrafts">
                                <!-- <div class="error alert alert-danger" *ngIf="responseMessage">{{responseMessage}}</div> -->
                                <div *ngIf="selectedMessage && selectedMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"  src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.personalDraftMessages}}</span>
                                </div>
                                <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                    <div class="chat-form">
                                        <div class="chat-content">
                                            <div class="inner-chat">
                                                <div class="chat-top-area">
                                                    <div class="chat-header">
                                                        <div class="chat-left"></div>
                                                        <div class="chat-right">
                                                            <ul>
                                                                <li><button type="button"
                                                                        (click)="deleteDraftMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                        tooltip="{{language.community_messages.delete}}"
                                                                        placement="bottom" delay="500"><i
                                                                            class="fa fa-trash"
                                                                            aria-hidden="true"></i>
                                                                    </button>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card draft_main">
                                            <form [formGroup]="messageForm" (ngSubmit)='messageProcess()'>
                                                <div class="card-body">
                                                    <!-- profile details data start -->
                                                    <div class="profile_details">
                                                        <!-- <div class="alert alert-danger" *ngIf="responseMessage">
                                                            {{responseMessage}}</div> -->
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="news-dropdown"
                                                                    *ngIf="personalVisiable && alluserDetails">
                                                                    <div class="multi_dropdown_main">
                                                                        <label>{{language.create_message.participantsto}}</label>
                                                                        <ng-multiselect-dropdown
                                                                            formControlName="receiver_id"
                                                                            [placeholder]="language.create_message.participantsto"
                                                                            [settings]="userDropdownSettings"
                                                                            [data]="userDropdownList"
                                                                            (onSelect)="onReceiverSelect($event)"
                                                                            (onDeSelect)="onReceiverDeSelect($event)">
                                                                        </ng-multiselect-dropdown>
                                                                        <label class="text-danger"
                                                                            *ngIf="messageSubmitted && messageForm.controls['receiver_id'].errors">{{language.error_message.common_required}}</label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="news-dropdown"
                                                                    *ngIf="!clubVisiable && personalVisiable && alluserDetails">
                                                                    <div class="multi_dropdown_main">
                                                                        <label>{{language.create_message.participantscc}}</label>
                                                                        <ng-multiselect-dropdown
                                                                            formControlName="cc"
                                                                            [placeholder]="language.create_message.participantscc"
                                                                            [settings]="userDropdownCCSettings"
                                                                            [data]="userDropdownCCList"
                                                                            (onSelect)="onCCSelect($event)">
                                                                        </ng-multiselect-dropdown>
                                                                        <label class="text-danger"
                                                                            *ngIf="messageSubmitted && messageForm.controls['cc'].errors">{{language.error_message.common_required}}</label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-12">
                                                                <div class="news-dropdown"
                                                                    *ngIf="groupVisiable && groups">
                                                                    <div class="multi_dropdown_main">
                                                                        <label>{{language.create_message.participantsto}}</label>
                                                                        <ng-multiselect-dropdown
                                                                            formControlName="kind_id"
                                                                            [placeholder]="language.create_message.participantsto"
                                                                            [settings]="groupDropdownSettings"
                                                                            [data]="groups"
                                                                            (onSelect)="onKindIdSelect($event)"
                                                                            (onDeSelect)="onKindIdDeSelect($event)">
                                                                        </ng-multiselect-dropdown>
                                                                        <label class="text-danger"
                                                                            *ngIf="messageSubmitted && messageForm.controls['kind_id'].errors">{{language.error_message.common_required}}</label>
                                                                    </div>
                                                                </div>
                                                                <div class="event_field">
                                                                    <label>{{language.create_message.subject}}</label>
                                                                    <input type="text" formControlName="subject"
                                                                        placeholder="{{language.create_message.subject_placeholder}}">
                                                                    <label class="text-danger"
                                                                        *ngIf="messageSubmitted && messageForm.controls['subject'].errors">{{language.error_message.common_required}}</label>
                                                                </div>
                                                                <div class="event_field task_area_field">
                                                                    <label>{{language.create_message.content}}</label>
                                                                    <textarea formControlName="content"
                                                                        placeholder="{{language.create_message.content_placeholder}}"></textarea>
                                                                    <label class="text-danger"
                                                                        *ngIf="messageSubmitted && messageForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- profile details data End -->
                                                    <div class="view-attachments"
                                                        *ngIf="stringifiedData(selectedMessage[0].attachments) && stringifiedData(selectedMessage[0].attachments).length > 0">
                                                        <div
                                                            *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                            </a>
                                                            <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                                href="{{attachment}}">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                                {{attachment.split('/').pop()}}
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="event_upload news_pic_upload">
                                                        <div class="message-upload-list" style="display: none;">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                            <label class="preview_txt"
                                                                style="display: none;"></label>
                                                        </div>
                                                    </div>
                                                    <div class="profile_sub_btn message_sub_btn">
                                                        <button type="submit"
                                                            class="save_btn">{{language.create_message.send}}</button>
                                                        <div class="message_upload">
                                                            <input type="file" (change)="uploadDraftFile($event)"
                                                                id="add_image">
                                                            <span class="message_upload_overlay">
                                                                <div class="upload_label">
                                                                    <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/attach.svg">
                                                                    <div class="up_text"> {{language.create_message.add_file}}<br><span>(Max 20Mb)</span>
                                                                    </div>
                                                                </div>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="personalAllMail">
                                <!-- <div class="error alert alert-danger" *ngIf="responseMessage">{{responseMessage}}</div> -->
                                <div *ngIf="selectedMessage && selectedMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.personalAllMessages}}</span>
                                </div>
                                <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                    <div class="chat-content">
                                        <div class="inner-chat">
                                            <div class="chat-top-area">
                                                <div class="chat-header">
                                                    <div class="chat-left" *ngIf="selectedMessage[0].user">
                                                        <div class="chat-user-img-main">
                                                            <div class="chat-user-img-in">
                                                                <div class="chat-user-img-in"
                                                                    *ngIf="selectedMessage[0].user.image == null || selectedMessage[0].user.image == '' ">
                                                                    <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/defaultProfile.jpeg">
                                                                </div>
                                                                <div class="chat-user-img-in"
                                                                    *ngIf="selectedMessage[0].user.image != null || selectedMessage[0].user.image != '' ">
                                                                    <img onContextMenu="return false;" alt="" loading="lazy" [src]="selectedMessage[0].user.image">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="user-detail-info ">
                                                            <div class="chat-user-name"
                                                                tooltip="{{selectedMessage[0].user.email}}"
                                                                placement="top" delay="500">
                                                                "{{selectedMessage[0].user.firstName}}
                                                                {{selectedMessage[0].user.lastName}}"
                                                            </div>
                                                            <div class="reply-date">{{selectedMessage[0].created_at | date: 'd. MMMM y' }} {{selectedMessage[0].created_at | date: 'HH:mm': 'GMT+2' }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="chat-right">
                                                        <ul>
                                                            <li><button type="button"
                                                                    (click)="replyToMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.reply}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-reply"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    *ngIf="selectedMessage[0].to.length > 1 || selectedMessage[0].cc.length > 0"
                                                                    (click)="replayToAllMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.replyToAll}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-reply-all"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    data-tooltip alt="Starred"><i
                                                                        class="fa fa-star-o"
                                                                        aria-hidden="true"></i></button></li>
                                                            <li><button type="button"
                                                                    (click)="deleteMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)"
                                                                    tooltip="{{language.community_messages.trash}}"
                                                                    placement="bottom" delay="500"><i
                                                                        class="fa fa-trash"
                                                                        aria-hidden="true"></i></button></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="reply-users">
                                                    <div class="more-toggle">
                                                        <i class="fa fa-caret-square-o-down" aria-hidden="true"
                                                            (click)="onShow()"></i>
                                                    </div>
                                                    <div class="cc-to-main">
                                                        <div class="chat-user-name">
                                                            {{language.create_message.participantsto}}-
                                                            <span *ngFor='let touser of selectedMessage[0].to'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                        <div class="chat-user-name"
                                                            *ngIf="selectedMessage[0].cc.length > 0">cc :-
                                                            <span *ngFor='let touser of selectedMessage[0].cc'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top"
                                                                    delay="500">"{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-inner-content">
                                                <h2>{{selectedMessage[0].subject}}</h2>
                                                <p>{{selectedMessage[0].content}}</p>
                                                <div class="view-attachments"
                                                    *ngIf="stringifiedData(selectedMessage[0].attachments) && stringifiedData(selectedMessage[0].attachments).length > 0">
                                                    <div
                                                        *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                        </a>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                            {{attachment.split('/').pop()}}
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-form" *ngIf="isReplyMsgForm">
                                        <h4 class="reply-heading" id="reply-heading"></h4>
                                        <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                            <div class="single-participent-reply reply-users"
                                                *ngIf="singleParticipent">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span>
                                                            <span class="to-username"
                                                                tooltip="{{alluserDetails[selectedMessage[0].sender_id].email}}"
                                                                placement="top"
                                                                delay="500">{{alluserDetails[selectedMessage[0].sender_id].firstname}}
                                                                {{alluserDetails[selectedMessage[0].sender_id].lastname}}</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="multipl-participent-reply reply-users"
                                                *ngIf="multipleParticipent && selectedMessage[0].to.length > 0">
                                                <div class="more-toggle"><i aria-hidden="true"
                                                        class="fa fa-caret-square-o-down" (click)="onOpen()"></i>
                                                </div>
                                                <div class="bottom-reply-to">
                                                    <div>
                                                        <Span>{{language.create_message.participantsto}} </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].to'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="to-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="top"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                    <div *ngIf="selectedMessage[0].cc.length > 0">
                                                        <Span>Cc: </Span>
                                                        <span *ngFor='let touser of selectedMessage[0].cc'>
                                                            <span *ngIf="touser && alluserDetails[touser]"
                                                                class="cc-username"
                                                                tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                placement="top"
                                                                delay="500">"{{alluserDetails[touser].firstname}}
                                                                {{alluserDetails[touser].lastname}}",</span>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="message_upload news_pic_upload">
                                                <div class="message-upload-list" style="display: none;">
                                                    <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                    <label class="preview_txt" style="display: none;"></label>
                                                </div>
                                            </div>
                                            <div class="chat-form-inner">
                                                <div class="chat-text-area">
                                                    <textarea type="text" formControlName="content"
                                                        placeholder="Type to compose your reply"></textarea>
                                                    <input type="hidden" id="replyMsgType" value="" />
                                                    <input type="hidden" id="replyToMsgId" value="" />
                                                    <label class="text-danger"
                                                        *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                </div>
                                                <div class="chat-btn-group">
                                                    <div class="chat_upload_btn"><input type="file"
                                                            (change)="uploadFile($event)" id="add_image">
                                                        <Span class="attach_icon"><img onContextMenu="return false;" alt="" loading="lazy"
                                                                src="assets/img/attach.svg"></Span>
                                                    </div>
                                                    <div class="chat_sent_btn"><button type="submit"><i
                                                                class="nc-icon nc-minimal-right"></i></button></div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="personalTrash">
                                <!-- <div class="error alert alert-danger" *ngIf="responseMessage">{{responseMessage}}</div> -->
                                <div *ngIf="selectedMessage && selectedMessage.length == 0" class="empty-data-image">
                                    <!-- <img onContextMenu="return false;" alt="" loading="lazy"
                                        src="../assets/img/no_record_img.png"><br> -->
                                        <span>{{language.community_messages.personalTrashMessages}}</span>
                                </div>
                                <div class="chat-screen" *ngIf="selectedMessage.length > 0">
                                    <div class="chat-content">
                                        <div class="inner-chat">
                                            <div class="chat-top-area">
                                                <div class="chat-header">
                                                    <div class="chat-left">
                                                        <div class="chat-user-img-main"
                                                            *ngIf="selectedMessage[0] && selectedMessage[0].user">
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image == null || selectedMessage[0].user.image == '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/defaultProfile.jpeg">
                                                            </div>
                                                            <div class="chat-user-img-in"
                                                                *ngIf="selectedMessage[0].user.image != null || selectedMessage[0].user.image != '' ">
                                                                <img onContextMenu="return false;" alt="" loading="lazy" [src]="selectedMessage[0].user.image">
                                                            </div>
                                                        </div>
                                                        <div class="user-detail-info ">
                                                            <div class="chat-user-name"
                                                                tooltip="{{selectedMessage[0].user.email}}"
                                                                placement="top" delay="500">
                                                                "{{selectedMessage[0].user.firstName}}
                                                                {{selectedMessage[0].user.lastName}}"
                                                            </div>
                                                            <div class="reply-date">{{selectedMessage[0].created_at | date: 'd. MMMM y' }} {{selectedMessage[0].created_at | date: 'HH:mm': 'GMT+2' }}</div>
                                                        </div>
                                                    </div>
                                                    <div class="chat-right">
                                                        <ul>
                                                            <li><button type="button"  data-tooltip alt="Starred"
                                                                 (click)="markedStarredMessages(selectedMessage[0].id, selectedMessage[0].esdb_id)">
                                                                    <i class="fa fa-star-o" aria-hidden="true"></i>
                                                                </button>
                                                            </li>
                                                            <li><button type="button"  tooltip="{{language.community_messages.delete}}" placement="bottom" delay="500"
                                                                    (click)="deleteMessagesPermanently(selectedMessage[0].id, selectedMessage[0].esdb_id)">
                                                                    <i class="fa fa-trash"  aria-hidden="true"></i>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="reply-users">
                                                    <div class="more-toggle">
                                                        <i class="fa fa-caret-square-o-down" aria-hidden="true"
                                                            (click)="onShow()"></i>
                                                    </div>
                                                    <div class="cc-to-main">
                                                        <div class="chat-user-name">
                                                            {{language.create_message.participantsto}}-
                                                            <span *ngFor='let touser of selectedMessage[0].to'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top" delay="500">
                                                                    "{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                        <div class="chat-user-name"
                                                            *ngIf="selectedMessage[0].cc.length > 0">cc :-
                                                            <span *ngFor='let touser of selectedMessage[0].cc'>
                                                                <span *ngIf="touser && alluserDetails[touser]"
                                                                    class="to-username"
                                                                    tooltip="{{alluserDetails && alluserDetails[touser]?.email}}"
                                                                    placement="top"
                                                                    delay="500">"{{alluserDetails[touser].firstname}}
                                                                    {{alluserDetails[touser].lastname}}",</span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="chat-inner-content">
                                                <h2>{{selectedMessage[0].subject}}</h2>
                                                <p>{{selectedMessage[0].content}}</p>
                                                <div class="view-attachments"
                                                    *ngIf="stringifiedData(selectedMessage[0].attachments) && stringifiedData(selectedMessage[0].attachments).length > 0">
                                                    <div
                                                        *ngFor='let attachment of stringifiedData(selectedMessage[0].attachments)'>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) !== -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="{{attachment}}" />
                                                        </a>
                                                        <a *ngIf="imageType.indexOf(attachment.split('.').pop()) == -1"
                                                            href="{{attachment}}">
                                                            <img onContextMenu="return false;" alt="" loading="lazy" src="assets/img/doc-icons/chat_doc_ic.png" />
                                                            {{attachment.split('/').pop()}}
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chat-form" *ngIf="isReplyMsgForm">
                                        <h4 class="reply-heading" id="reply-heading"></h4>
                                        <form [formGroup]="replyMsgForm" (ngSubmit)='replyMessage()'>
                                            <div class="chat-form-inner">
                                                <div class="message_upload news_pic_upload">
                                                    <div class="message-upload-list" style="display: none;">
                                                        <img onContextMenu="return false;" alt="" loading="lazy" class="preview_img" src="">
                                                        <label class="preview_txt" style="display: none;"></label>
                                                    </div>
                                                </div>
                                                <div class="chat-text-area">
                                                    <textarea type="text" formControlName="content"
                                                        placeholder="Type to compose your reply"></textarea>
                                                    <input type="hidden" id="replyMsgType" value="" />
                                                    <input type="hidden" id="replyToMsgId" value="" />
                                                    <label class="text-danger"
                                                        *ngIf="replyMsgSubmitted && replyMsgForm.controls['content'].errors">{{language.error_message.common_required}}</label>
                                                </div>
                                                <div class="chat-btn-group">
                                                    <div class="chat_upload_btn"><input type="file"
                                                            (change)="uploadFile($event)" id="add_image">
                                                        <Span class="attach_icon">
                                                            <img onContextMenu="return false;" alt="" loading="lazy"  src="assets/img/attach.svg"></Span>
                                                    </div>
                                                    <div class="chat_sent_btn"><button type="submit"><i class="nc-icon nc-minimal-right"></i></button></div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<ng-container *ngIf="!messageData">
    <app-mpersonal-message ></app-mpersonal-message>
</ng-container>
